---
title: "OpenShift Container Platform 설치하기"
date: 2020-07-03 11:00:00 +0900
categories: Kubernetes
tags: OpenShift
sidebar:
  nav: "main"
---

### IBM Power Systems 에 OpenShift Container Platform 4.4.9 설치하기

얼마전에 나온 OCP 4.4.9 를 IBM Power에 설치해 보았습니다.
전반적으로 OpenShift Documentation 사이트의 정보가 도움이 되었지만, PowerVM 환경에 대한 고려사항이 나와 있지 않아 다소 애를 먹었습니다.

#### 인터넷 및 텔레메트리 액세스 확인
OCP를 설치하려면, 설치할 노드에서 외부 인터넷 액세스가 가능한지 확인해야 합니다. 일단 설치 프로그램을 인터넷에서 다운로드 받아야 하고, 서브스크립션 관리 작업과 클러스터 설치/업데이트에 필요한 패키지를 다운로드 받아야 하므로 인터넷 액세스가 가능해야 합니다.  
또한 텔레메트리라는 클러스터 상태와 업데이트 성공 여부를 측정하는 서비스를 위해서도 인터넷 액세스가 필요합니다.

#### 프라이빗 클라우드 인프라에 OCP 클러스터를 구성하기 위한 인프라 조건

|노드유형|노드수|
|:--------:|:------:|
|Bootstrap 노드|1|
|Master 노드|3|
|Worker 노드|2|

\* Bootstrap 은 OCP 클러스터를 설치할 때만 필요하고, 설치가 완료된 이후에는 필요 없으므로 지워도 됩니다.

Bootstrap, Master, Worker 노드에는 Red Hat Enterprise Linux CoreOS(RHCOS)가 설치됩니다.

#### 네트워크 요구사항

모든 RHCOS 노드들은 부팅하면서 initramfs 에 명시된 네트워크에 액세스해서 ignition config 파일을 가져옵니다. 따라서 초기 부팅할 때 DHCP 서버가 준비되어 있거나, DHCP 서버가 없을 경우 Static IP address가 설정되어 있어야 합니다.

#### 노드별 최소 요구사항

각 클러스터 노드의 HW 최소 요구사항

|노드|운영체제|vCPU|RAM|Storage|노드수|
|:-------:|:---------:|:-------:|:--------:|:---------:|:----:|
|Bootstrap|RHCOS|2|16 GB|120 GB|1|
|Master|RHCOS|2|16 GB|120 GB|3|
|Worker|RHCOS|2|8 GB|120 GB|2|

\* 주의사항 : IBM Power 서버는 PowerVM 환경에서 기본 SMT8 모드를 지원하므로, 설정된 가상 코어수 (Virtual Processor)에 8배수를 한 개수가 vCPU로 인식됩니다. 예를 들어, VP 를 1로 설정했다면, RHCOS에서는 8개의 Logical CPU 가 보입니다. 마스터 노드의 경우, vCPU 개수가 많으면 커널 메모리를 많이 필요로 하므로 초기 구성시 마스터 노드의 VP개수를 1이나 2로 설정하는 것을 권장합니다.
